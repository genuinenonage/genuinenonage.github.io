<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.13.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="项目简介暂时设计B2C，未来项目成熟后，转向C2C。 分布式基础部分  分布式的基本概念 微服务、注册中心、配置中心、feign远程调用、网关（统一配置跨域）   基础开发 Spring Boot 2.0 、Spring Cloud、Mybatis-Plus、Vue组件化、阿里云对象存储   环境 Linux、Docker、MySql、Redis、逆向工程&amp;人人开源   开发规范 数据校验">
<meta property="og:type" content="article">
<meta property="og:title" content="商城项目（一）">
<meta property="og:url" content="http://example.com/2020/10/19/%E9%A1%B9%E7%9B%AE/%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE1/index.html">
<meta property="og:site_name" content="genuine nonage">
<meta property="og:description" content="项目简介暂时设计B2C，未来项目成熟后，转向C2C。 分布式基础部分  分布式的基本概念 微服务、注册中心、配置中心、feign远程调用、网关（统一配置跨域）   基础开发 Spring Boot 2.0 、Spring Cloud、Mybatis-Plus、Vue组件化、阿里云对象存储   环境 Linux、Docker、MySql、Redis、逆向工程&amp;人人开源   开发规范 数据校验">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-10-19T07:03:00.000Z">
<meta property="article:modified_time" content="2021-04-23T01:57:21.605Z">
<meta property="article:author" content="QB">
<meta property="article:tag" content="商城">
<meta property="article:tag" content="springclooud">
<meta property="article:tag" content="gateway">
<meta property="article:tag" content="docker">
<meta property="article:tag" content="nacos">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2020/10/19/%E9%A1%B9%E7%9B%AE/%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE1/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2020/10/19/%E9%A1%B9%E7%9B%AE/%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE1/","path":"2020/10/19/项目/商城项目1/","title":"商城项目（一）"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>商城项目（一） | genuine nonage</title>
  






  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">genuine nonage</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">减少放电，增加充电</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E7%AE%80%E4%BB%8B"><span class="nav-number">1.</span> <span class="nav-text">项目简介</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E6%8A%80%E6%9C%AF%E7%89%B9%E7%82%B9%EF%BC%9A"><span class="nav-number">1.1.</span> <span class="nav-text">项目技术特点：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84"><span class="nav-number">1.2.</span> <span class="nav-text">微服务架构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86"><span class="nav-number">1.3.</span> <span class="nav-text">知识</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%A7%8B"><span class="nav-number">2.</span> <span class="nav-text">项目开始</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%AE%89%E8%A3%85%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B7%A5%E5%85%B7-docker-mysql-redis"><span class="nav-number">2.1.</span> <span class="nav-text">1.安装服务器工具(docker,mysql,redis)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%AE%89%E8%A3%85%E7%94%B5%E8%84%91%E5%B7%A5%E5%85%B7"><span class="nav-number">2.2.</span> <span class="nav-text">2. 安装电脑工具</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E6%90%AD%E5%BB%BA%E8%84%9A%E6%89%8B%E6%9E%B6"><span class="nav-number">2.3.</span> <span class="nav-text">3. 搭建脚手架</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E5%BE%AE%E6%9C%8D%E5%8A%A1"><span class="nav-number">2.4.</span> <span class="nav-text">4. 微服务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E5%92%8COpenFeign%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8"><span class="nav-number">2.4.1.</span> <span class="nav-text">Nacos注册中心和OpenFeign远程调用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83"><span class="nav-number">2.4.2.</span> <span class="nav-text">Nacos配置中心</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#API%E7%BD%91%E5%85%B3-Gateway"><span class="nav-number">2.4.3.</span> <span class="nav-text">API网关 Gateway</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E9%97%AE%E9%A2%98%E5%BE%85%E8%A7%A3%E5%86%B3"><span class="nav-number">3.</span> <span class="nav-text">项目问题待解决</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Maven-plugins-%E7%88%86%E7%BA%A2%EF%BC%8C%E6%97%A0%E6%B3%95%E5%AF%BC%E5%85%A5"><span class="nav-number">3.0.1.</span> <span class="nav-text">Maven plugins 爆红，无法导入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#springcloud%E7%89%88%E6%9C%AC%E9%97%AE%E9%A2%98"><span class="nav-number">3.0.2.</span> <span class="nav-text">springcloud版本问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Java%E8%A7%A3%E5%86%B3Excel%EF%BC%88POI%EF%BC%89"><span class="nav-number">3.0.3.</span> <span class="nav-text">Java解决Excel（POI）</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">QB</p>
  <div class="site-description" itemprop="description">菜鸡</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">73</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">59</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/10/19/%E9%A1%B9%E7%9B%AE/%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="QB">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="genuine nonage">
      <meta itemprop="description" content="菜鸡">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="商城项目（一） | genuine nonage">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          商城项目（一）
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-10-19 15:03:00" itemprop="dateCreated datePublished" datetime="2020-10-19T15:03:00+08:00">2020-10-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-04-23 09:57:21" itemprop="dateModified" datetime="2021-04-23T09:57:21+08:00">2021-04-23</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h1><p>暂时设计B2C，未来项目成熟后，转向C2C。</p>
<p>分布式基础部分</p>
<ol>
<li>分布式的基本概念<ul>
<li>微服务、注册中心、配置中心、feign远程调用、网关（统一配置跨域）</li>
</ul>
</li>
<li>基础开发<ul>
<li>Spring Boot 2.0 、Spring Cloud、Mybatis-Plus、Vue组件化、阿里云对象存储</li>
</ul>
</li>
<li>环境<ul>
<li>Linux、Docker、MySql、Redis、逆向工程&amp;人人开源</li>
</ul>
</li>
<li>开发规范<ul>
<li>数据校验JSR303、全局异常处理、全局统一返回、全局跨域处理</li>
<li>枚举状态、业务状态码、VO与TO与PO划分、逻辑删除</li>
<li>Lombok：@Data、@Slf4j</li>
</ul>
</li>
</ol>
<h2 id="项目技术特点："><a href="#项目技术特点：" class="headerlink" title="项目技术特点："></a>项目技术特点：</h2><p>前后端分离开发，开发基于vue的后台管理系统</p>
<p>SpringCloud全新的解决方案</p>
<p>应用监控、限流、网关、熔断降级等分布式方案，全方位涉及</p>
<p>分布式事务、分布式锁等分布式系统难题</p>
<p>高并发场景，线程池、异步编排等使用</p>
<p>压力测试，性能优化</p>
<p>各种集群技术使用</p>
<p>CI/CD使用</p>
<h2 id="微服务架构"><a href="#微服务架构" class="headerlink" title="微服务架构"></a>微服务架构</h2><p>微服务：拒绝大型单体应用，基于业务边界进行服务强化拆分，服务独立部署运行。</p>
<h2 id="知识"><a href="#知识" class="headerlink" title="知识"></a>知识</h2><p>网络地址转换</p>
<h1 id="项目开始"><a href="#项目开始" class="headerlink" title="项目开始"></a>项目开始</h1><h2 id="1-安装服务器工具-docker-mysql-redis"><a href="#1-安装服务器工具-docker-mysql-redis" class="headerlink" title="1.安装服务器工具(docker,mysql,redis)"></a>1.安装服务器工具(docker,mysql,redis)</h2><ol>
<li><p>安装虚拟机</p>
<ol>
<li><p>安装VirtualBox</p>
</li>
<li><p>安装 vagrant 快速搭建虚拟机</p>
<ol>
<li><p>安装成功后重启系统。</p>
</li>
<li><p>cmd输入命令vagrant测试是否安装成功。</p>
</li>
<li><p>cmd输入vagrant init centos/7</p>
</li>
<li><p>cmd输入vagrant up 启动虚拟机（停止可以在VirtualBox中停止）</p>
</li>
<li><p>cmd输入vagrant ssh 链接上虚拟机</p>
<blockquote>
<p>vagrant reload   重启虚拟机</p>
</blockquote>
</li>
</ol>
</li>
</ol>
</li>
<li><p>安装docker</p>
<ol>
<li><p>卸载旧版本docke</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-engine</span><br></pre></td></tr></table></figure></blockquote>
</li>
<li><p>下载</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum install -y yum-utils</span><br><span class="line"></span><br><span class="line">$ sudo yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https://download.docker.com/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure></blockquote>
</li>
<li><p>安装</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure></blockquote>
</li>
<li><p>启动</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl start docker</span><br></pre></td></tr></table></figure></blockquote>
</li>
<li><p>检查当前虚拟机的镜像</p>
<blockquote>
<p>$ sudo docker images</p>
</blockquote>
</li>
<li><p>设置开机自启动</p>
<blockquote>
<p>$ sudo systemctl enable docker</p>
</blockquote>
</li>
<li><p>配置镜像加速</p>
<blockquote>
<p>在阿里云查找镜像加速器</p>
<p>sudo mkdir -p /etc/docker</p>
<p>sudo tee /etc/docker/daemon.json &lt;&lt;-‘EOF’ </p>
<p>{</p>
<p> “registry-mirrors”: [“<a href="https://x7tuoc0z.mirror.aliyuncs.com&quot;]">https://x7tuoc0z.mirror.aliyuncs.com&quot;]</a> </p>
<p>} </p>
<p>EOF</p>
<p>sudo systemctl daemon-reload </p>
<p>sudo systemctl restart docker</p>
</blockquote>
</li>
<li><p>其他的使用</p>
<blockquote>
<p>如果遇到docker镜像重启无法使用，就重启docker</p>
<p>systemctl restart docker</p>
<p>查看正在运行中的容器</p>
<p>docker ps</p>
<p>查看全部容器</p>
<p>docker ps -a</p>
<p>删除容器</p>
<p>docker rm -f 容器名</p>
<p>docker rmi 容器名</p>
<p>停止容器</p>
<p>docker stop 容器id</p>
<p>启动容器</p>
<p>docker start 容器id</p>
<p>删除镜像</p>
<p>docker rmi mysql:8.0</p>
<p>重启容器</p>
<p>docker restart 容器名</p>
<p>设置容器开机自启</p>
<p>docker update –restart=always 容器名</p>
</blockquote>
</li>
</ol>
</li>
<li><p>docker安装mysql</p>
<ol>
<li><p>mysql57</p>
<ol>
<li><p>下载MySQL57镜像</p>
<blockquote>
<p>docker pull mysql:5.7</p>
</blockquote>
</li>
<li><p>创建my.cnf文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /mydata/mysql57/conf/</span><br><span class="line">touch /mydata/mysql57/conf/my.cnf</span><br></pre></td></tr></table></figure></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">   [client]</span><br><span class="line">default-character-set=utf8</span><br><span class="line">   </span><br><span class="line">[mysql]</span><br><span class="line">   default-character-set=utf8</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">   init_connect=&#x27;SET collation_connection=utf8_unicode_ci&#x27;</span><br><span class="line">   init_connect=&#x27;SET NAMES utf8&#x27;</span><br><span class="line">   character-set-server=utf8</span><br><span class="line">   collation-server=utf8_unicode_ci</span><br><span class="line">   skip-character-set-client-handshake</span><br><span class="line">   skip-name-resolve</span><br><span class="line">   max_connections=1500</span><br></pre></td></tr></table></figure></li>
<li><p>安装</p>
<blockquote>
<p>docker run -p 3306:3306 –name mysql57 <br>-v /mydata/mysql57/log:/var/log/mysql <br>-v /mydata/mysql57/data:/var/lib/mysql <br>-v /mydata/mysql57/conf:/etc/mysql <br>-e MYSQL_ROOT_PASSWORD=Aa19990804 <br>-d mysql:5.7</p>
</blockquote>
<blockquote>
<p>docker run -p 3306:3306 –name mysql57 -v $PWD/conf:/etc/mysql/conf.d -v $PWD/log:/logs -v $PWD/data:/mysql_data -e MYSQL_ROOT_PASSWORD=Aa19990804 -d mysql:5.7</p>
</blockquote>
<ol start="4">
<li><p>进入容器</p>
<blockquote>
<p>docker exec -it mysql57 /bin/bash</p>
</blockquote>
</li>
</ol>
</li>
<li><p>mysql8</p>
<ol>
<li><p>下载MySQL8.0镜像</p>
<blockquote>
<p>docker pull mysql:8.0</p>
</blockquote>
</li>
<li><p>创建my.cnf文件</p>
<blockquote>
<p>vi /mydata/mysql8/conf/my.cnf</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">      [mysqld]</span><br><span class="line">      pid-file        = /var/run/mysqld/mysqld.pid</span><br><span class="line">      socket          = /var/run/mysqld/mysqld.sock</span><br><span class="line">      datadir         = /var/lib/mysql</span><br><span class="line">      secure-file-priv= NULL</span><br><span class="line">      # Disabling symbolic-links is recommended to prevent assorted security risks</span><br><span class="line">      symbolic-links=0</span><br><span class="line"></span><br><span class="line">      # Custom config should go here</span><br><span class="line">!includedir /etc/mysql/conf.d/</span><br><span class="line">      </span><br><span class="line">      default_authentication_plugin= mysql_native_password</span><br></pre></td></tr></table></figure></li>
<li><p>安装</p>
<blockquote>
<p>docker run <br>-p 3307:3306 <br>-e MYSQL_ROOT_PASSWORD=root <br>-v /mydata/mysql8/data:/var/lib/mysql:rw <br>-v /mydata/mysql8/log:/var/log/mysql:rw <br>-v /mydata/mysql8/conf/my.cnf:/etc/mysql/my.cnf:rw <br>-v /etc/localtime:/etc/localtime:ro <br>–name mysql8 <br>–restart=always <br>-d mysql:8.0</p>
</blockquote>
</li>
<li><p>进入容器</p>
<blockquote>
<p>docker exec -it mysql8 /bin/bash</p>
</blockquote>
</li>
</ol>
</li>
</ol>
</li>
<li><p>docker安装redis</p>
<ol>
<li><p>下载镜像</p>
<blockquote>
<p>docker pull redis</p>
</blockquote>
</li>
<li><p>创建配置</p>
<blockquote>
<p>mkdir -p /mydata/redis/conf</p>
<p>touch /mydata/redis/conf/redis.conf </p>
</blockquote>
</li>
<li><p>运行容器</p>
<blockquote>
<p>docker run -p 6379:6379 –name redis -v /mydata/redis/data:/data -v /mydata/redis/conf/redis.conf:/etc/redis/redis.conf -d redis redis-server /etc/redis/redis.conf</p>
</blockquote>
</li>
<li><p>开启redis客户端</p>
<blockquote>
<p>docker exec -it redis redis-cli</p>
<p>redis默认是没有持久化的，数据存储在内存中。</p>
</blockquote>
</li>
<li><p>在Linux中编辑redis.conf文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">appendonly yes</span><br><span class="line">让redis启用aof的持久化方式</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<h2 id="2-安装电脑工具"><a href="#2-安装电脑工具" class="headerlink" title="2. 安装电脑工具"></a>2. 安装电脑工具</h2><p>完成navicat，redisdesktopmanager，idea，vxcode，maven，git工具的安装与配置</p>
<h2 id="3-搭建脚手架"><a href="#3-搭建脚手架" class="headerlink" title="3. 搭建脚手架"></a>3. 搭建脚手架</h2><ol>
<li><p>在码云创建一个仓库java,maven。</p>
</li>
<li><p>在idea中新建Project from version control</p>
</li>
<li><p>创建项目微服务</p>
<ol>
<li>```txt<br>共同点：<ol>
<li>web，openfeign</li>
<li>每个服务，包名com.genuine.wmall.xxx(product/order/ware/coupon/member)</li>
<li>模块名：wmall-<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   2. 创建所有模块module，使用spring快速搭建，由于是**微服务**，必要的两个依赖web的**springweb**和**springcloudrouting的openfeign**</span><br><span class="line"></span><br><span class="line">4. 在wmall中创建并编辑pom.xml</span><br><span class="line"></span><br><span class="line">   关联各个微服务</span><br><span class="line"></span><br><span class="line">   ```xml</span><br><span class="line">   &lt;groupId&gt;com.genuine.wmall&lt;/groupId&gt;</span><br><span class="line">       &lt;artifactId&gt;wmall&lt;/artifactId&gt;</span><br><span class="line">       &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;</span><br><span class="line">       &lt;name&gt;wmall&lt;/name&gt;</span><br><span class="line">       &lt;description&gt;聚合服务&lt;/description&gt;</span><br><span class="line">   	&lt;!-- 使用maven分模块管理 一般所有父级项目的packaging都为pom，packaging默认类型jar类型，如果不做配置，maven会将该项目打成jar包。 --&gt;</span><br><span class="line">       &lt;packaging&gt;pom&lt;/packaging&gt;</span><br><span class="line">       &lt;modules&gt;</span><br><span class="line">           &lt;module&gt;wmall-coupon&lt;/module&gt;</span><br><span class="line">           &lt;module&gt;wmall-member&lt;/module&gt;</span><br><span class="line">           &lt;module&gt;wmall-order&lt;/module&gt;</span><br><span class="line">           &lt;module&gt;wmall-product&lt;/module&gt;</span><br><span class="line">           &lt;module&gt;wmall-ware&lt;/module&gt;</span><br><span class="line">       &lt;/modules&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
<li><p>在maven中添加wmall模块（默认使root模块）。</p>
</li>
<li><p>在wmall中的.gitignore（git的模板，可以忽视垃圾文件）</p>
<p><strong>忽略设置：使git不上传远程仓库规定文件</strong></p>
<p>只将有用的代码纳入版本控制（Add VCS）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">**/  -- 代表任意目录</span><br><span class="line"></span><br><span class="line">**/mvnw</span><br><span class="line">**/mvnw.cmd</span><br><span class="line">**/.mvn</span><br><span class="line">**/target</span><br><span class="line">.idea</span><br><span class="line">**/.gitignore</span><br></pre></td></tr></table></figure></li>
<li><p>设计数据库</p>
<p>设计表，创建表。</p>
<p>在电商项目中表与表之间不做外键。</p>
<p>每一个服务创建自己的数据库。</p>
</li>
<li><p><strong>反向创建代码</strong></p>
<p>自动创建数据库实体类，dao层，service层</p>
<ol>
<li><p>构建数据库</p>
</li>
<li><p>下载人人开源的renren-fast和renren-fast-vue项目。</p>
</li>
<li><p>将两个项目的.git文件夹删掉</p>
</li>
<li><p>将renren-fast项目放入后台项目中，加入modules中，并创建数据库，之后可以运行测试。</p>
</li>
<li><p>使用vscode打开renren-fast-vue项目。</p>
<blockquote>
<p>npm install</p>
<p>npm run duv</p>
</blockquote>
</li>
<li><p>登录账户密码：admin   admin</p>
</li>
<li><p>下载并安装代码生成器renren-generator项目，放入wmall项目中，加入modules中，修改application.yml文件中的数据库配置。修改generator.properties文件中的配置</p>
<blockquote>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mainPath</span>=<span class="string">com.genuine</span></span><br><span class="line"><span class="attr">package</span>=<span class="string">com.genuine.wmall</span></span><br><span class="line"><span class="attr">moduleName</span>=<span class="string">product</span></span><br><span class="line"><span class="attr">author</span>=<span class="string">xuanhuanxingkong8</span></span><br><span class="line"><span class="attr">email</span>=<span class="string">xuanhuanxingkong8@gmail.com</span></span><br><span class="line"><span class="attr">tablePrefix</span>=<span class="string">pms</span></span><br></pre></td></tr></table></figure></blockquote>
</li>
<li><p>运行代码生成器服务</p>
</li>
<li><p>根据数据库的表，生成代码，导入到项目中。</p>
</li>
<li><p>修改程序中的报错的问题，将公共工具放到common模块中。</p>
</li>
<li><p><strong>整合MyBatis-Plus</strong></p>
<ol>
<li><p>导入依赖</p>
</li>
<li><p>配置</p>
<ol>
<li><p>配置数据源</p>
<ol>
<li><p>导入数据库驱动</p>
</li>
<li><p>配置数据源相关信息</p>
</li>
<li><p>配置MyBatis-Plus</p>
<pre><code>1. 使用@MapperScan
  
2. 告诉MyBatis-Plus，sql映射文件位置
  
   <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://81.70.204.157:3306/gulimall_pms</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line"><span class="comment"># 表主键自增</span></span><br><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="attr">id-type:</span> <span class="string">auto</span></span><br><span class="line">  <span class="comment"># mapper-locations: classpath*:/mapper/**/*.xml</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath:/mapper/**/*.xml</span></span><br></pre></td></tr></table></figure>
  
   classpath后*表示任意模块路径下的mapper的任意路径下的任意.xml结尾的文件。
</code></pre>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<h2 id="4-微服务"><a href="#4-微服务" class="headerlink" title="4. 微服务"></a>4. 微服务</h2><p>技术搭配方案：</p>
<p>Nacos：注册中心（服务发现/注册）</p>
<p>Nacos：配置中心（动态配置管理）</p>
<p>Ribbon：负载均衡</p>
<p>Feign：声明式HTTP客户端（调用远程服务）</p>
<p>Sentinel：服务容错（限流、降级、熔断）</p>
<p>Gateway：API网关（webflux编程模式）</p>
<p>Sleuth：调用链监控</p>
<p>Seata：原Fescar，分布式事务解决方案</p>
<h3 id="Nacos注册中心和OpenFeign远程调用"><a href="#Nacos注册中心和OpenFeign远程调用" class="headerlink" title="Nacos注册中心和OpenFeign远程调用"></a>Nacos注册中心和OpenFeign远程调用</h3><ol>
<li><p>分布式组件spring cloud alibaba</p>
<p>导入依赖：</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>下载nacos服务器（注册中心、配置中心），并启动服务。</p>
<p><strong>在项目配置文件中配置Nacos Server地址和当前服务名</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  cloud:</span><br><span class="line">    nacos:</span><br><span class="line">      discovery:</span><br><span class="line">        server-addr: <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">8848</span></span><br><span class="line">  application:</span><br><span class="line">    name: 项目名</span><br></pre></td></tr></table></figure>

<p><strong>使用@EnableDiscoveryClient注解开启服务注册与发现功能</strong></p>
<p>运行项目</p>
</li>
<li><p>Feign声明式远程调用</p>
<p>简介：Feign是一个声明式的HTTP客户端。整合了Ribbon（负载均衡）和Hystrix（服务熔断）。</p>
<p>步骤：</p>
<ol>
<li><p>引入open-feign</p>
</li>
<li><p>编写一个接口，需要调用远程服务</p>
<ol>
<li><p>声明接口的每一个方法都是调用那个远程服务的请求。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//被调用方 类中</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/member/list&quot;)</span></span><br><span class="line"><span class="keyword">public</span> R <span class="title function_">membercoupons</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">CouponEntity</span> <span class="variable">couponEntity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CouponEntity</span>();</span><br><span class="line">    couponEntity.setCouponName(<span class="string">&quot;满100减10&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> R.ok().put(<span class="string">&quot;coupons&quot;</span>,Arrays.asList(couponEntity));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//调用远程服务的服务名</span></span><br><span class="line"><span class="meta">@FeignClient(&quot;wmall-coupon&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CouponFeignService</span> &#123;</span><br><span class="line">    <span class="comment">//使用接口的完整签名</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/coupon/coupon/member/list&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> R <span class="title function_">membercoupons</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line">调用方 类中</span><br><span class="line">   </span><br><span class="line">   ```java</span><br><span class="line">   //test调用方 类中</span><br><span class="line">   @Autowired</span><br><span class="line">   CouponFeignService couponFeignService;</span><br><span class="line">   </span><br><span class="line">   @RequestMapping(&quot;/coupons&quot;)</span><br><span class="line">public R test()&#123;</span><br><span class="line">       MemberEntity memberEntity = new MemberEntity();</span><br><span class="line">    memberEntity.setNickname(&quot;张三&quot;);</span><br><span class="line">       R membercoupons = couponFeignService.membercoupons();</span><br><span class="line">       return R.ok().put(&quot;member&quot;,memberEntity).put(&quot;coupons&quot;,membercoupons.get(&quot;coupons&quot;));</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>调用方 启动类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//开启远程调用功能 自动扫描 全包名</span></span><br><span class="line"><span class="meta">@EnableFeignClients(basePackages = &quot;com.genuine.wmall.member.feign&quot;)</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WmallMemberApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(WmallMemberApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在浏览器发送请求：localhost:8000/member/member/coupons</p>
<p>附：如果服务停止，前端会显示，连接超时。</p>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<h3 id="Nacos配置中心"><a href="#Nacos配置中心" class="headerlink" title="Nacos配置中心"></a>Nacos配置中心</h3><ol>
<li><p>引入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--使用配置中心做配置管理--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>创建一个bootstrap.properties文件</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.application.name</span>=<span class="string">wmall-coupon项目名</span></span><br><span class="line"><span class="attr">spring.cloud.nacos.config.server-addr</span>=<span class="string">127.0.0.1:8848</span></span><br></pre></td></tr></table></figure></li>
<li><p>给配置中心默认添加一个 数据集（Data Id）。 默认规则：应用名.properties</p>
</li>
<li><p>给 应用名.properties 添加任何配置</p>
</li>
<li><p>动态获取配置。</p>
<ol>
<li><p>@RefreshScope 动态获取，并刷新配置。可应用在控制器类名上</p>
</li>
<li><p>@Value(${配置项名})  获取到配置</p>
<p>当配置中心和当前应用都配置了相同的项，优先使用配置中心的配置。</p>
</li>
</ol>
</li>
<li><p>细节：</p>
<ol>
<li><p>命名空间：配置隔离：</p>
<p>默认：public（保留空间）</p>
<p>基于不同环境隔离：开发，测试，生产：利用命名空间做环境隔离。</p>
<p>注意：在bootstrap.properties中配置</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.cloud.nacos.config.namespace</span>=<span class="string">bf179235-e27b-42e6-b162-8b598e0a2bae</span></span><br></pre></td></tr></table></figure>

<p><strong>基于微服务隔离</strong>：每一个微服务之间互相隔离配置，每一个微服务都创建自己的命名空间，只加载自己明明空间下的所有配置。</p>
</li>
<li><p>配置集：所有的配置的集合。</p>
</li>
<li><p>配置集id：类似于文件名。就是Data ID</p>
</li>
<li><p>配置分组：默认所有配置集都属于：DEFAULT_GROUP</p>
<p><strong>每个微服务创建自己的命名空间，使用配置分组区分环境。</strong> 分组：dev、prod</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.cloud.nacos.config.group</span>=<span class="string">dev Group名</span></span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>同时加载多个配置集</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置集id</span></span><br><span class="line"><span class="attr">spring.cloud.nacos.config.ext-config[0].data-id</span>=<span class="string">datasource.yml</span></span><br><span class="line"><span class="comment"># 配置分组</span></span><br><span class="line"><span class="attr">spring.cloud.nacos.config.ext-config[0].group</span>=<span class="string">dev</span></span><br><span class="line"><span class="comment"># 启动配置刷新</span></span><br><span class="line"><span class="attr">spring.cloud.nacos.config.ext-config[0].refresh</span>=<span class="string">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring.cloud.nacos.config.ext-config[1].data-id</span>=<span class="string">mybatis.yml</span></span><br><span class="line"><span class="attr">spring.cloud.nacos.config.ext-config[1].group</span>=<span class="string">dev</span></span><br><span class="line"><span class="attr">spring.cloud.nacos.config.ext-config[1].refresh</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">...</span></span><br></pre></td></tr></table></figure>

<ol>
<li>微服务任何配置信息，任何配置文件都可以放在配置中心中。</li>
<li>只需要在bootstrap.properties说明加载配置中心的哪些配置文件即可。</li>
<li>SpringBoot任何方法从配置文件中获取值，都能使用配置中心获取文件。</li>
</ol>
</li>
</ol>
<h3 id="API网关-Gateway"><a href="#API网关-Gateway" class="headerlink" title="API网关 Gateway"></a>API网关 Gateway</h3><p>分布式开发中需要api网关：</p>
<ol>
<li>实时的接受注册中心的服务是否上线，将请求转发到正确的目标服务。</li>
<li>不将登录校验的功能分布到每一个服务上，在网关服务上实现。</li>
</ol>
<p><strong>Gateway简介</strong>：</p>
<p>网关作为流量的入口，常用功能包括 <strong>路由转发、权限校验、限流控制等</strong>，而spring cloud gateway 作为SpringCloud官方推出的第二代网关框架，取代了Zuul网关。</p>
<p>（每秒能处理三万多的请求，请求到达网关，通过断言，是否符合路由规则，然后经过filter路由到指定地方） </p>
<p>学习Gateway，在官方文档中学习与使用。</p>
<p>断言：判断请求是否符合路由规则，符合就经过一系列filter过滤后到达指定地点。</p>
<ol>
<li><p>新建网关项目，仅依赖网关gateway</p>
</li>
<li><p>依赖common工程，注册到common中</p>
</li>
<li><p>统一gateway的spring版本与springcloud版本</p>
</li>
<li><p>开启服务注册发现（配置服务信息）</p>
<p>启动类中添加@EnableDiscoveryClient</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># application.properties 配置nacos注册中心</span></span><br><span class="line"><span class="attr">spring.cloud.nacos.discovery.server-addr</span>=<span class="string">127.0.0.1:8848</span></span><br><span class="line"><span class="attr">spring.application.name</span>=<span class="string">wmall-gateway</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">88</span></span><br></pre></td></tr></table></figure>

<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># bootstrap.properties 配置nacos配置中心</span></span><br><span class="line"><span class="attr">spring.cloud.nacos.config.server-addr</span>=<span class="string">127.0.0.1:8848</span></span><br><span class="line"><span class="attr">spring.cloud.nacos.config.namespace</span>=<span class="string">da468fd0-0579-4ac8-b473-f93211213424</span></span><br><span class="line"><span class="attr">spring.cloud.nacos.config.group</span>=<span class="string">dev</span></span><br><span class="line"><span class="attr">spring.application.name</span>=<span class="string">wmall-coupon</span></span><br></pre></td></tr></table></figure>

<p>有需要时，在配置中心配置</p>
<p>启动网关的时候会遇到数据源相关的错误，网关排除掉跟数据库相关的自动配置 @SpringBootApplication(exclude = DataSourceAutoConfiguration.class)</p>
<p>网关是基于Netty启动的。</p>
<p>请求转发：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">test_route</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">https://www.baidu.com</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Query=baz</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">qq_route</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">https://www.qq.com</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Query=url,</span> <span class="string">qq</span></span><br></pre></td></tr></table></figure>

<p>浏览器输入localhost:88/?baz 会跳转到百度页面</p>
<p>输入localhost:88/?url=qq 会跳转到qq页面</p>
</li>
</ol>
<h1 id="项目问题待解决"><a href="#项目问题待解决" class="headerlink" title="项目问题待解决"></a>项目问题待解决</h1><h3 id="Maven-plugins-爆红，无法导入"><a href="#Maven-plugins-爆红，无法导入" class="headerlink" title="Maven plugins 爆红，无法导入"></a>Maven plugins 爆红，无法导入</h3><h3 id="springcloud版本问题"><a href="#springcloud版本问题" class="headerlink" title="springcloud版本问题"></a>springcloud版本问题</h3><p>已解决，我已经全部换成:</p>
<p>spring-boot-starter-parent 2.1.3.RELEASE</p>
<p>spring-cloud.version Greenwich.SR3</p>
<ol>
<li><p>gulimall-common</p>
</li>
<li><p>gulimall-coupon<br>spring-boot-starter-parent 2.4.1<br>spring-cloud.version 2020.0.0-M6</p>
</li>
<li><p>gulimall-member<br>spring-boot-starter-parent 2.3.4.RELEASE<br>spring-cloud.version Greenwich.SR3</p>
</li>
<li><p>gulimall-order</p>
<p>spring-boot-starter-parent 2.4.1<br>spring-cloud.version 2020.0.0-M6</p>
</li>
<li><p>gulimall-product</p>
<p>spring-boot-starter-parent 2.3.5.RELEASE<br>spring-cloud.version Greenwich.SR3</p>
</li>
<li><p>gulimall-ware</p>
<p>spring-boot-starter-parent 2.4.1<br>spring-cloud.version 2020.0.0-M6</p>
</li>
</ol>
<h3 id="Java解决Excel（POI）"><a href="#Java解决Excel（POI）" class="headerlink" title="Java解决Excel（POI）"></a>Java解决Excel（POI）</h3><p>已解决，如果maven阿里云仓库没有最新的依赖，阿里云将会去国外中央仓库下载</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%95%86%E5%9F%8E/" rel="tag"># 商城</a>
              <a href="/tags/springclooud/" rel="tag"># springclooud</a>
              <a href="/tags/gateway/" rel="tag"># gateway</a>
              <a href="/tags/docker/" rel="tag"># docker</a>
              <a href="/tags/nacos/" rel="tag"># nacos</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/10/12/Tomcat%E9%97%AE%E9%A2%98/" rel="prev" title="tomcat问题">
                  <i class="fa fa-chevron-left"></i> tomcat问题
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/11/10/%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/" rel="next" title="">
                   <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">QB</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  




<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"genuinenonage/comments","issue_term":"pathname","theme":"github-light"}</script>
<script src="/js/third-party/comments/utterances.js"></script>

</body>
</html>
