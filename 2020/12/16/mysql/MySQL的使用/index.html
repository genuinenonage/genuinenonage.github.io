<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.13.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="命令常用操作查看创建表结构1SHOW CREATE TABLE table_name  优雅操作多字段中文排序12345select t1.value,t2.chinese_namefrom dictionary as t1 right join website as t2 on t1.uuid&#x3D;t2.countrywhere t1.type&#x3D;&quot;country&quot;ORDER BY">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL的使用">
<meta property="og:url" content="http://example.com/2020/12/16/mysql/MySQL%E7%9A%84%E4%BD%BF%E7%94%A8/index.html">
<meta property="og:site_name" content="genuine nonage">
<meta property="og:description" content="命令常用操作查看创建表结构1SHOW CREATE TABLE table_name  优雅操作多字段中文排序12345select t1.value,t2.chinese_namefrom dictionary as t1 right join website as t2 on t1.uuid&#x3D;t2.countrywhere t1.type&#x3D;&quot;country&quot;ORDER BY">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/06/28/AnZBQPNa29ToCf4.png">
<meta property="og:image" content="https://z3.ax1x.com/2021/06/28/RUkTTH.png">
<meta property="og:image" content="https://z3.ax1x.com/2021/06/28/RUmSFe.png">
<meta property="article:published_time" content="2020-12-16T06:53:00.000Z">
<meta property="article:modified_time" content="2022-09-23T15:18:29.740Z">
<meta property="article:author" content="QB">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="学习">
<meta property="article:tag" content="配置">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/06/28/AnZBQPNa29ToCf4.png">


<link rel="canonical" href="http://example.com/2020/12/16/mysql/MySQL%E7%9A%84%E4%BD%BF%E7%94%A8/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2020/12/16/mysql/MySQL%E7%9A%84%E4%BD%BF%E7%94%A8/","path":"2020/12/16/mysql/MySQL的使用/","title":"MySQL的使用"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>MySQL的使用 | genuine nonage</title>
  






  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">genuine nonage</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">减少放电，增加充电</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4"><span class="nav-number">1.</span> <span class="nav-text">命令</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C"><span class="nav-number">1.1.</span> <span class="nav-text">常用操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%88%9B%E5%BB%BA%E8%A1%A8%E7%BB%93%E6%9E%84"><span class="nav-number">1.1.1.</span> <span class="nav-text">查看创建表结构</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%98%E9%9B%85%E6%93%8D%E4%BD%9C"><span class="nav-number">1.2.</span> <span class="nav-text">优雅操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E5%AD%97%E6%AE%B5%E4%B8%AD%E6%96%87%E6%8E%92%E5%BA%8F"><span class="nav-number">1.2.1.</span> <span class="nav-text">多字段中文排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%98%E5%9C%A8%E4%B8%BB%E8%A1%A8%E4%B8%8D%E5%9C%A8%E5%8F%A6%E4%B8%80%E4%B8%AA%E8%A1%A8%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="nav-number">1.2.2.</span> <span class="nav-text">存在主表不在另一个表中的数据</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE"><span class="nav-number">2.</span> <span class="nav-text">配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#useSSL"><span class="nav-number">2.1.</span> <span class="nav-text">useSSL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SSL"><span class="nav-number">2.1.1.</span> <span class="nav-text">SSL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#useSSL-false-true"><span class="nav-number">2.1.2.</span> <span class="nav-text">useSSL&#x3D;false &#x2F; true</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80"><span class="nav-number">3.</span> <span class="nav-text">基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1"><span class="nav-number">3.1.</span> <span class="nav-text">数据库对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE"><span class="nav-number">3.1.1.</span> <span class="nav-text">视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">3.1.2.</span> <span class="nav-text">存储过程</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3"><span class="nav-number">4.</span> <span class="nav-text">深入了解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95"><span class="nav-number">4.1.</span> <span class="nav-text">索引</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">4.1.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E7%B1%BB"><span class="nav-number">4.1.2.</span> <span class="nav-text">分类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%A7%E8%83%BD"><span class="nav-number">4.2.</span> <span class="nav-text">性能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%A2%E8%AF%95%E5%90%8D%E8%AF%8D"><span class="nav-number">4.3.</span> <span class="nav-text">面试名词</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9E%E8%A1%A8"><span class="nav-number">4.3.1.</span> <span class="nav-text">回表</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">QB</p>
  <div class="site-description" itemprop="description">菜鸡</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">72</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">29</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">57</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/16/mysql/MySQL%E7%9A%84%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="QB">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="genuine nonage">
      <meta itemprop="description" content="菜鸡">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="MySQL的使用 | genuine nonage">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL的使用
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-16 14:53:00" itemprop="dateCreated datePublished" datetime="2020-12-16T14:53:00+08:00">2020-12-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-09-23 23:18:29" itemprop="dateModified" datetime="2022-09-23T23:18:29+08:00">2022-09-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h1><h2 id="常用操作"><a href="#常用操作" class="headerlink" title="常用操作"></a>常用操作</h2><h3 id="查看创建表结构"><a href="#查看创建表结构" class="headerlink" title="查看创建表结构"></a>查看创建表结构</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table_name</span><br></pre></td></tr></table></figure>

<h2 id="优雅操作"><a href="#优雅操作" class="headerlink" title="优雅操作"></a>优雅操作</h2><h3 id="多字段中文排序"><a href="#多字段中文排序" class="headerlink" title="多字段中文排序"></a>多字段中文排序</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select t1.value,t2.chinese_name</span><br><span class="line">from dictionary as t1 </span><br><span class="line">right join website as t2 on t1.uuid=t2.country</span><br><span class="line">where t1.type=&quot;country&quot;</span><br><span class="line">ORDER BY CONVERT(t1.value USING gbk), CONVERT(t2.chinese_name USING gbk)</span><br></pre></td></tr></table></figure>

<h3 id="存在主表不在另一个表中的数据"><a href="#存在主表不在另一个表中的数据" class="headerlink" title="存在主表不在另一个表中的数据"></a>存在主表不在另一个表中的数据</h3><p>三种实现方式：</p>
<ol>
<li><p>使用not in，容易理解，效率最低</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> A.ID <span class="keyword">from</span> A <span class="keyword">where</span> A.ID <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> ID <span class="keyword">from</span> B)</span><br></pre></td></tr></table></figure></li>
<li><p>使用左连接字段为空的记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> A.ID <span class="keyword">from</span> A <span class="keyword">left</span> <span class="keyword">join</span> B A.ID <span class="operator">=</span> B.ID <span class="keyword">where</span> B.ID <span class="keyword">is</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure></li>
<li><p>逻辑复杂，速度最快</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> A <span class="keyword">where</span> (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">as</span> num <span class="keyword">from</span> A <span class="keyword">where</span> A.ID <span class="operator">=</span> B.ID ) <span class="operator">=</span> <span class="number">0</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h2 id="useSSL"><a href="#useSSL" class="headerlink" title="useSSL"></a>useSSL</h2><h3 id="SSL"><a href="#SSL" class="headerlink" title="SSL"></a>SSL</h3><p>SSL(Secure Sockets Layer 安全套接字协议),及其继任者传输层安全（Transport Layer Security，TLS）是为网络通信提供安全及数据完整性的一种安全协议。</p>
<p>TLS与SSL在传输层与应用层之间对网络连接进行加密。</p>
<p>SSL协议提供服务主要：</p>
<ol>
<li>认证用户服务器，确保数据发送到正确的服务器；</li>
<li>加密数据，防止数据传输途中被窃取使用；</li>
<li>维护数据完整性，验证数据在传输过程中是否丢失；</li>
</ol>
<h3 id="useSSL-false-true"><a href="#useSSL-false-true" class="headerlink" title="useSSL=false / true"></a>useSSL=false / true</h3><p><strong>mysql连接中是否要设置成useSSL=true / false 与数据库中的用户的设置有关，每个数据库的用户都有一个sslType属性，如果设置了值，就需要useSSL设置成true，如果没有设置值，useSS设置成false。</strong></p>
<p><strong>SSL协议的作用，用于对敏感的数据进行加密，类似http与https的区别。</strong></p>
<p>MySQL在高版本需要指明是否进行SSL连接</p>
<ol>
<li>true 需要连接</li>
<li>false 不需要连接</li>
</ol>
<p>web应用中连接mysql数据库时后台会出现这样的提示：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Establishing SSL connection without server’s identity verification is not recommended. According to MySQL 5.5.45+,</span><br><span class="line">5.6.26+ and 5.7.6+ requirements SSL connection must be established by default if explicit option isn’t set. For compliance with existing applications not using SSL the verifyServerCertificate property is set to ‘false’. You need either to explicitly disable SSL by setting useSSL=false, or set useSSL=true and provide truststore for server certificate verification.</span><br></pre></td></tr></table></figure>

<p>解决</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">url=jdbc:mysql://127.0.0.1:3306/xxx?useSSL=false</span></span><br></pre></td></tr></table></figure>

<h1 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h1><h2 id="数据库对象"><a href="#数据库对象" class="headerlink" title="数据库对象"></a>数据库对象</h2><ol>
<li>表</li>
<li>数据字典：系统表</li>
<li>约束：保证数据的完整性</li>
<li>视图</li>
<li>索引</li>
<li>存储过程</li>
<li>存储函数</li>
<li>触发器 </li>
</ol>
<h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><p>使用表的一部分，针对不用的用户指定不同的查询视图。视图为虚拟表，可以理解为存储起来的select语句。</p>
<p>create view 视图名 as select</p>
<p>对视图中的数据进行增加删除修改操作，数据库相应发生变化。优点：控制数据访问的权限。</p>
<h3 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h3><p>一组经过预先编译的sql封装。</p>
<p>函数一定会有返回值。存储过程可以没有返回值。</p>
<p>好处：</p>
<ol>
<li>提高sql语句的重用性</li>
<li>减少操作失误，提高效率</li>
<li>减少网络传输量</li>
<li>减少sql语句网络暴露的网上风险，提高数据查询的安全性。</li>
</ol>
<p>与视图的区别：视图偏向于查询看重成是一张表，存储过程用来存储sql，结构更加复杂，看中sql逻辑。</p>
<h1 id="深入了解"><a href="#深入了解" class="headerlink" title="深入了解"></a>深入了解</h1><p>MySQL架构：连接层-（服务层）处理层-引擎层-存储层</p>
<p>业务逻辑处理层包括：连接池-管理服务与工具-SQL处理接口-解析转换-优化器-缓存和缓冲。</p>
<p>存储引擎相关命令：show engines;</p>
<p>MyISAM与InnoDB数据库引擎对比：</p>
<p><img src="https://i.loli.net/2021/06/28/AnZBQPNa29ToCf4.png" alt="image-20210628143712555"></p>
<p>SQL性能下降原因：</p>
<ol>
<li>性能下降了SQL慢；执行时间长；等待时间长；<ol>
<li>查询语句写的烂</li>
<li>索引失效（单值、符合）</li>
<li>关联太多join（设计缺陷或不得已的需求）</li>
<li>服务器调优及各个参数设置（缓冲、线程数等）</li>
</ol>
</li>
</ol>
<h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><p>创建索引命令：create index idx_user_name on user(name, email)</p>
<p>SQL的Join查询：</p>
<ol>
<li><p>SQL执行顺序：</p>
<ol>
<li><p>手写顺序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> <span class="operator">&lt;&gt;</span></span><br><span class="line"><span class="keyword">from</span> <span class="operator">&lt;&gt;</span></span><br><span class="line"><span class="operator">&lt;&gt;</span> <span class="keyword">join</span> <span class="operator">&lt;&gt;</span> <span class="keyword">on</span> <span class="operator">&lt;</span>公有部分用来配对<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">where</span> <span class="operator">&lt;&gt;</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="operator">&lt;&gt;</span></span><br><span class="line"><span class="keyword">having</span> <span class="operator">&lt;&gt;</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="operator">&lt;&gt;</span></span><br><span class="line">limit <span class="operator">&lt;&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>机读顺序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> <span class="operator">&lt;&gt;</span></span><br><span class="line"><span class="keyword">on</span> <span class="operator">&lt;&gt;</span></span><br><span class="line"><span class="operator">&lt;&gt;</span> <span class="keyword">join</span> <span class="operator">&lt;&gt;</span></span><br><span class="line"><span class="keyword">where</span> <span class="operator">&lt;&gt;</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="operator">&lt;&gt;</span></span><br><span class="line"><span class="keyword">having</span> <span class="operator">&lt;&gt;</span></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line"><span class="keyword">distinct</span> <span class="operator">&lt;&gt;</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="operator">&lt;&gt;</span></span><br><span class="line">limit <span class="operator">&lt;&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>Join图：left join; right join; inner join; full outer join(全外连接：a.key is null or b.key is null)</p>
</li>
</ol>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>索引简介：索引（Index）帮助MySQL高效获取数据的数据结构。</p>
<ol>
<li><p>B数（多路搜索树）索引，B+树索引，哈希索引</p>
</li>
<li><p>索引优势：</p>
<ol>
<li>提高数据检索的效率，降低数据库的IO成本；</li>
<li>降低数据排序的成本，降低了CPU的消耗。</li>
</ol>
</li>
<li><p>索引劣势：</p>
<ol>
<li>索引也是一张表，保存了主键与索引字段，并指向实体库的记录。占空间。</li>
<li>提高了查询速度，却降低了更新表的速度</li>
<li>索引只是提高效率的一个因素，如果MySQL有大数据量的表，需要花时间研究建立最优秀的索引或优化查询。</li>
</ol>
</li>
</ol>
<h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><p>索引分类：</p>
<ol>
<li>单值索引：一个索引只包含单个列，一个表可以有多个单值索引。</li>
<li>唯一索引：索引列的值必须唯一，但允许有空值。</li>
<li>复合索引：一个索引包含多个列。</li>
<li>基本语法：<ol>
<li>创建：<ol>
<li>create &lt;&gt; index indexName ON mytable(columnname(length))</li>
<li>alter mytable ADD &lt;&gt; index [indexName] ON (columnname(length))</li>
</ol>
</li>
<li>删除：drop index [indexName] ON mytable;</li>
<li>查看：show index from tableName;</li>
</ol>
</li>
</ol>
<p>mysql索引结构包括：BTree；Hash索引；full-text全文索引；R-Tree索引。</p>
<p>BTree树图形结构：</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/RUkTTH"><img src="https://z3.ax1x.com/2021/06/28/RUkTTH.png" alt="RUkTTH.png"></a></p>
<p>需要创建索引的情况：</p>
<ol>
<li>主键自动创建唯一索引。</li>
<li>频繁作为查找条件的字段应创建索引。</li>
<li>查询中与其他表关联的字段，外键关系建立索引。</li>
<li>频繁更新的字段不适合创建索引</li>
<li>where条件里用不到的字段不创建索引。</li>
<li>单键/组合索引选择？（高并发倾向组合索引）</li>
<li>排序字段若通过索引去访问将提高排序速度。</li>
<li>查询中统计或者分组字段</li>
</ol>
<p>不需要创建索引的情况：</p>
<ol>
<li>表记录太少</li>
<li>经常增删改的表</li>
<li>某数据列包含许多重复的内容</li>
</ol>
<h2 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h2><p>性能分析：</p>
<ol>
<li><p>MySQL常见瓶颈：</p>
<ol>
<li>CPU：CPU在饱和的时候一般发生在数据装入内存或从磁盘上读取数据时</li>
<li>IO：发生在装入数据远大于内存容量的时候</li>
<li>服务器硬件的性能瓶颈</li>
</ol>
</li>
<li><p>Explain</p>
<ol>
<li><p>是什么：执行计划。</p>
</li>
<li><p>干什么： </p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/RUmSFe"><img src="https://z3.ax1x.com/2021/06/28/RUmSFe.png" alt="RUmSFe.png"></a></p>
</li>
<li><p>怎么用：</p>
<ol>
<li>explain+SQL语句</li>
<li>执行计划包含的信息：id  select_type  table  type  possible_keys  key  key_len  ref  rows  Extra</li>
</ol>
</li>
<li><p>名词解释：</p>
<ol>
<li>id：查询的序列号<ol>
<li>id相同：执行顺序由上至下</li>
<li>id不同：id越大优先级越高</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li><p>select_type：查询的类型，用于区别普通、联合、子查询等的复杂情况。</p>
<pre><code>  1. simple：简单查询，不包括子查询或者union
  2. primary：查询中包含子查询，最外层的查询
  3. subquery：子查询
  4. derived：子查询作为衍生，结果放到临时表
  5. union：第二个select出现在union之后，别被纪委union。若union包还在from子句的子查询中，外层select将被标记为derived。
  6. union result：从union表获取结果的select
</code></pre>
<ol start="3">
<li>table：哪张表</li>
<li>type：<ol>
<li>显示查询使用的了何种类型</li>
<li>从最好到最差依次是：system&gt;const&gt;eq_ref&gt;ref&gt;range&gt;index&gt;ALL</li>
<li>system：表只有一行记录</li>
<li>const：通过索引能找到唯一记录。（主键或唯一索引）</li>
<li>eq_ref：唯一性索引扫描，每个索引键，表中只有一条记录与之匹配。</li>
<li>ref：非唯一性索引扫描，返回匹配某个单独值的所有行。</li>
<li>range：之间所指定范围的行，使用一个索引来选择行。</li>
<li>index：全索引扫描，读取索引中的数据。索引文件比数据文件小。</li>
<li>ALL：遍历所有数据</li>
</ol>
</li>
<li>possible_keys：显示可能应用在这张表中的索引。</li>
<li>key：实际查询时，使用的索引。</li>
<li>key_len：索引使用的字节数。查询中使用的索引的长度。长度越短越好。</li>
<li>ref：显示索引那一列被使用了。</li>
<li>rows：找到记录读取的行数。</li>
<li>Extra：包含不在其他列的重要的信息<ol>
<li><strong>Using filesort</strong>：不好；mysql没有使用索引排序，使用的外部排序。（文件排序）</li>
<li><strong>Using temportry</strong>：不好；使用了临时表。</li>
<li><strong>Using index</strong>：很好；（覆盖索引 Covering Index select节u功德数据从索引中取得，不必根据索引读取数据文件）</li>
<li>Using where：使用罗where过滤；</li>
<li>using join buffer：使用了连接缓存；</li>
<li>impossible where：where的结果总是false；</li>
<li>distinct：找到第一个匹配，不再找相同的。</li>
</ol>
</li>
</ol>
</li>
</ol>
<p>union操作符：用于合并两个或多个select语句的结果集。默认选取不同的值。如果允许重复，使用union all。</p>
<p>索引优化：</p>
<p>两表优化方案，左连接查询，给右表建立索引。右连接查询，给左表建立索引。</p>
<h2 id="面试名词"><a href="#面试名词" class="headerlink" title="面试名词"></a>面试名词</h2><h3 id="回表"><a href="#回表" class="headerlink" title="回表"></a>回表</h3><p>一个索引无法把数据查询出来，需要通过前几个索引最后再次查询逐渐索引才能把select的所有数据都查询出来。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/MySQL/" rel="tag"># MySQL</a>
              <a href="/tags/%E5%AD%A6%E4%B9%A0/" rel="tag"># 学习</a>
              <a href="/tags/%E9%85%8D%E7%BD%AE/" rel="tag"># 配置</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/12/11/Zookeeper/" rel="prev" title="Zookeeper了解">
                  <i class="fa fa-chevron-left"></i> Zookeeper了解
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/12/22/Maven/" rel="next" title="Maven知识点">
                  Maven知识点 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">QB</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  




<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"genuinenonage/comments","issue_term":"pathname","theme":"github-light"}</script>
<script src="/js/third-party/comments/utterances.js"></script>

</body>
</html>
